#include QMK_KEYBOARD_H

//https://docs.qmk.fm/#/keycodes
//Tap Dance Declarations
enum {
  TD_SH_CAPS = 0
};

//Tap Dance Definitions
qk_tap_dance_action_t tap_dance_actions[] = {
  //Tap once for Esc, twice for Caps Lock
  [TD_SH_CAPS]  = ACTION_TAP_DANCE_DOUBLE(TD(KC_RSFT), KC_CAPS)
// Other declarations would go here, separated by commas, if you have them
};

enum custom_keycodes {
    KC_JIGGLER = SAFE_RANGE,
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

  //┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐                                                                           ┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐                                         ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤                                         ├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐       ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────┬───┴────────────┬───┼────────────────┼────────────────┤       ├────────────────┼────────────────┼───────────┬────┴───────────┬────┼────────────────┼────────────────┼────────────────┼────────────────┤
  //└────────────────┴────────────────┴────────────────┴────────────────┘            └────────────────┘   └────────────────┴────────────────┘       └────────────────┴────────────────┘           └────────────────┘    └────────────────┴────────────────┴────────────────┴────────────────┘

    [0] = LAYOUT(

  //┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐                                                                           ┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐
          KC_GRV,           KC_1,           KC_2,             KC_3,             KC_4,           KC_5,                                                                                         KC_6,             KC_7,           KC_8,           KC_9,           KC_0,             KC_MINS,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐                                         ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_TAB,           KC_Q,           KC_W,             KC_E,             KC_R,           KC_T,          KC_LBRC,                                                   KC_RBRC,            KC_Y,             KC_U,           KC_I,           KC_O,           KC_P,             KC_EQL,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤                                         ├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_ESC,           LT(3, KC_A),    LT(1, KC_S),        KC_D,         LT(6, KC_F),        KC_G,           KC_NO,                                                    KC_BSLS,            KC_H,             KC_J,           KC_K,           KC_L,       LT(4, KC_SCLN),     KC_QUOT,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐       ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_LSFT,          LT(2, KC_Z),      KC_X,             KC_C,           KC_V,             KC_B,           KC_PGUP,        KC_PGDN,              KC_HOME,            KC_END,             KC_N,             KC_M,           KC_COMM,        KC_DOT,       KC_SLSH,          TD(TD_SH_CAPS),
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────┬───┴────────────┬───┼────────────────┼────────────────┤       ├────────────────┼────────────────┼───────────┬────┴───────────┬────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_LGUI,          KC_NO,            KC_NO,            KC_LALT,                       KC_LCTL,           KC_BSPC,          KC_DEL,                 KC_ENT,           KC_SPC,                     KC_RCTL,                KC_RALT,            MO(5),        KC_NO,            KC_NO
  //└────────────────┴────────────────┴────────────────┴────────────────┘            └────────────────┘   └────────────────┴────────────────┘       └────────────────┴────────────────┘           └────────────────┘    └────────────────┴────────────────┴────────────────┴────────────────┘
    ),


    [1] = LAYOUT(
  //┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐                                                                           ┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐
          KC_NO,          KC_NO,          KC_NO,             KC_NO,         KC_NO,            KC_NO,                                                                                        KC_NO,            KC_NO,          KC_NO,          KC_NO,          KC_NO,            KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐                                         ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_TAB,         KC_NO,          KC_NO,              KC_NO,        KC_NO,              KC_NO,          KC_NO,                                                    KC_NO,          KC_PPLS,            KC_PMNS,        KC_PSLS,        KC_PAST,          KC_EQL,         KC_COMM,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤                                         ├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_ESC,         KC_NO,          KC_NO,              KC_NO,        KC_NO,              KC_NO,          KC_NO,                                                    KC_NO,          KC_0,               KC_1,           KC_2,           KC_3,             KC_4,           KC_DOT,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐       ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_LSFT,        KC_NO,          KC_NO,              KC_NO,        KC_NO,              KC_NO,          KC_NO,          KC_NO,                    KC_NO,          KC_NO,              KC_5,           KC_6,             KC_7,         KC_8,             KC_9,           TD(TD_SH_CAPS),
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────┬───┴────────────┬───┼────────────────┼────────────────┤       ├────────────────┼────────────────┼───────────┬────┴───────────┬────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_LGUI,        KC_NO,          KC_NO,              KC_LALT,                      KC_LCTL,            KC_BSPC,          KC_DEL,                   KC_ENT,         KC_SPC,                       KC_RCTL,             KC_RALT,         KC_NO,        KC_NO,            KC_NO
  //└────────────────┴────────────────┴────────────────┴────────────────┘            └────────────────┘   └────────────────┴────────────────┘       └────────────────┴────────────────┘           └────────────────┘    └────────────────┴────────────────┴────────────────┴────────────────┘
   ),



    [2] = LAYOUT(
  //┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐                                                                           ┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐
          KC_NO,          KC_NO,            KC_NO,          KC_NO,          KC_NO,            KC_NO,                                                                                        KC_NO,            KC_NO,          KC_NO,          KC_NO,            KC_NO,            KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐                                         ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_TAB,         KC_NO,            KC_NO,          KC_MS_U,        KC_NO,          KC_NO,            KC_NO,                                                    KC_PSCR,          KC_NO,            KC_BRID,        KC_BRIU,        KC_NO,            KC_NO,          KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤                                         ├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_ESC,         KC_NO,            KC_MS_L,        KC_MS_D,        KC_MS_R,          KC_NO,            KC_NO,                                                    KC_JIGGLER,     KC_NO,              KC_ACL2,      KC_ACL1,          KC_ACL0,          KC_NO,          KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐       ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_LSFT,        KC_NO,            KC_NO,          KC_NO,          KC_NO,          KC_NO,            KC_WH_L,          KC_WH_R,                KC_MRWD,          KC_MFFD,          KC_MPLY,          KC_MPRV,      KC_MNXT,          KC_VOLD,          KC_VOLU,      KC_MUTE,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────┬───┴────────────┬───┼────────────────┼────────────────┤       ├────────────────┼────────────────┼───────────┬────┴───────────┬────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_LGUI,        KC_NO,          KC_NO,        KC_LALT,                          KC_LCTL,            KC_WH_U,          KC_WH_D,                KC_BTN1,          KC_BTN2,                    KC_RCTL,              KC_RALT,          KC_NO,        KC_NO,            KC_NO
  //└────────────────┴────────────────┴────────────────┴────────────────┘            └────────────────┘   └────────────────┴────────────────┘       └────────────────┴────────────────┘           └────────────────┘    └────────────────┴────────────────┴────────────────┴────────────────┘
),




    [3] = LAYOUT(
  //┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐                                                                           ┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐
        KC_NO,              KC_NO,          KC_NO,            KC_NO,            KC_NO,        KC_NO,                                                                                      KC_NO,            KC_NO,            KC_NO,          KC_NO,           KC_NO,             KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐                                         ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_TAB,             KC_NO,          KC_NO,            KC_NO,          KC_NO,          KC_NO,              KC_NO,                                                  KC_NO,          KC_NO,            KC_GRV,           KC_TILD,        KC_NO,          KC_NO,              KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤                                         ├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_ESC,             KC_NO,          KC_NO,            KC_NO,          KC_NO,          KC_NO,            KC_NO,                                                    KC_NO,          KC_NO,            KC_LPRN,          KC_RPRN,        KC_LCBR,          KC_RCBR,            KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐       ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_LSFT,            KC_NO,          KC_NO,            KC_NO,          KC_NO,            KC_NO,            KC_NO,        KC_NO,                  KC_NO,            KC_NO,          KC_NO,            KC_LBRC,        KC_RBRC,          KC_MINS,          KC_UNDS,          TD(TD_SH_CAPS),
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────┬───┴────────────┬───┼────────────────┼────────────────┤       ├────────────────┼────────────────┼───────────┬────┴───────────┬────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_LGUI,            KC_NO,          KC_NO,            KC_LALT,                        KC_LCTL,          KC_BSPC,          KC_DEL,                 KC_ENT,           KC_SPC,                     KC_RCTL,              KC_RALT,          KC_NO,          KC_NO,          KC_NO
  //└────────────────┴────────────────┴────────────────┴────────────────┘            └────────────────┘   └────────────────┴────────────────┘       └────────────────┴────────────────┘           └────────────────┘    └────────────────┴────────────────┴────────────────┴────────────────┘
),




    [4] = LAYOUT(
  //┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐                                                                           ┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐
         KC_NO,             KC_NO,        KC_NO,            KC_NO,            KC_NO,            KC_NO,                                                                                    KC_NO,              KC_NO,            KC_NO,          KC_NO,        KC_NO,             KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐                                         ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
         KC_TAB,            KC_NO,          KC_PIPE,          KC_PLUS,          KC_EQL,         KC_NO,          KC_NO,                                                    KC_NO,          KC_NO,            KC_NO,            KC_NO,          KC_NO,            KC_NO,          KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤                                         ├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
         KC_ESC,            KC_EXLM,        KC_AT,          KC_HASH,          KC_DLR,         KC_NO,            KC_NO,                                                    KC_NO,          KC_NO,            KC_NO,          KC_NO,            KC_NO,            KC_NO,            KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐       ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
         KC_LSFT,           KC_PERC,        KC_CIRC,          KC_AMPR,        KC_ASTR,        KC_NO,            KC_NO,            KC_NO,                KC_NO,          KC_NO,            KC_NO,            KC_NO,            KC_NO,        KC_NO,                KC_NO,            TD(TD_SH_CAPS),
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────┬───┴────────────┬───┼────────────────┼────────────────┤       ├────────────────┼────────────────┼───────────┬────┴───────────┬────┼────────────────┼────────────────┼────────────────┼────────────────┤
         KC_LGUI,             KC_NO,          KC_NO,             KC_LALT,                      KC_LCTL,            KC_BSPC,          KC_DEL,               KC_ENT,         KC_SPC,                         KC_RCTL,           KC_RALT,          KC_NO,          KC_NO,          KC_NO
  //└────────────────┴────────────────┴────────────────┴────────────────┘            └────────────────┘   └────────────────┴────────────────┘       └────────────────┴────────────────┘           └────────────────┘    └────────────────┴────────────────┴────────────────┴────────────────┘
),


    [5] = LAYOUT(
  //┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐                                                                           ┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐
          KC_NO,            KC_NO,          KC_NO,            KC_NO,          KC_NO,            KC_NO,                                                                                    KC_NO,            KC_NO,            KC_NO,          KC_NO,            KC_PWR,         KC_SLEP,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐                                         ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_TAB,           KC_F1,          KC_F2,            KC_F3,          KC_F4,            KC_NO,           KC_NO,                                                   KC_NO,          KC_NO,            KC_NO,            KC_NO,          KC_NO,            KC_NO,          KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤                                         ├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_ESC,           KC_F5,          KC_F6,            KC_F7,          KC_F8,            KC_NO,          KC_NO,                                                    KC_NO,          KC_NO,            KC_NO,            KC_NO,          KC_NO,            KC_NO,          KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐       ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_LSFT,         KC_F9,           KC_F10,           KC_F11,         KC_F12,           KC_NO,        KC_NO,            KC_NO,                  KC_NO,            KC_NO,          KC_NO,            KC_NO,            KC_NO,          KC_NO,            KC_NO,          TD(TD_SH_CAPS),
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────┬───┴────────────┬───┼────────────────┼────────────────┤       ├────────────────┼────────────────┼───────────┬────┴───────────┬────┼────────────────┼────────────────┼────────────────┼────────────────┤
          KC_LGUI,        KC_NO,          KC_NO,            KC_LALT,                      KC_LCTL,            KC_BSPC,          KC_DEL,                 KC_ENT,           KC_SPC,                     KC_RCTL,                KC_RALT,        KC_NO,          KC_NO,          KC_NO
  //└────────────────┴────────────────┴────────────────┴────────────────┘            └────────────────┘   └────────────────┴────────────────┘       └────────────────┴────────────────┘           └────────────────┘    └────────────────┴────────────────┴────────────────┴────────────────┘
  ),


    [6] = LAYOUT(
  //┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐                                                                           ┌────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────┐
        KC_NO,            KC_NO,              KC_NO,            KC_NO,        KC_NO,            KC_NO,                                                                                      KC_NO,            KC_NO,        KC_NO,              KC_NO,          KC_NO,            KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐                                         ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_TAB,           KC_NO,              KC_NO,          KC_NO,          KC_NO,          KC_NO,          KC_NO,                                                      KC_NO,            KC_NO,          KC_LGUI,          KC_LCTL,          KC_NO,          KC_NO,          KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤                                         ├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_ESC,           KC_NO,              KC_NO,          KC_NO,          KC_NO,          KC_NO,            KC_NO,                                                    KC_NO,            KC_LEFT,        KC_DOWN,          KC_UP,            KC_RGHT,        KC_NO,          KC_NO,
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┐       ┌────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_LSFT,          KC_NO,              KC_NO,          KC_NO,          KC_NO,          KC_NO,             KC_NO,         KC_NO,                  KC_NO,            KC_NO,            KC_NO,          KC_NO,            KC_NO,            KC_NO,          KC_NO,          TD(TD_SH_CAPS),
  //├────────────────┼────────────────┼────────────────┼────────────────┼────────────┬───┴────────────┬───┼────────────────┼────────────────┤       ├────────────────┼────────────────┼───────────┬────┴───────────┬────┼────────────────┼────────────────┼────────────────┼────────────────┤
        KC_LGUI,          KC_NO,              KC_NO,          KC_LALT,                      KC_LCTL,            KC_BSPC,            KC_DEL,               KC_ENT,           KC_SPC,                     KC_RCTL,              KC_RALT,            KC_NO,            KC_NO,          KC_NO
  //└────────────────┴────────────────┴────────────────┴────────────────┘            └────────────────┘   └────────────────┴────────────────┘       └────────────────┴────────────────┘           └────────────────┘    └────────────────┴────────────────┴────────────────┴────────────────┘
)

};

bool mouse_jiggle_mode = false;

void matrix_init_user(void) {
}

void matrix_scan_user(void) {
  static int counter=0;
  if (mouse_jiggle_mode) {
    ++counter;
    if(counter == 100)
    {
      tap_code(KC_MS_UP);
      tap_code(KC_MS_DOWN);
      counter = 0;
    }
  }
}

bool process_record_user(uint16_t keycode, keyrecord_t *record) {
  switch (keycode) {
    case KC_JIGGLER:
      if (record->event.pressed) {
        if (mouse_jiggle_mode) {
            mouse_jiggle_mode = false;
        } else {
            mouse_jiggle_mode = true;
        }
      // SEND_STRING(SS_DELAY(100)); //uncomment if it switches too fast before the button debounces
      } else {}
      break;
  }
  return true;
}

// ATmega32U4
// tested qmk_toolbox commit: 2709b6ed616f8012ff4cfd3ee69a822a8d188351
